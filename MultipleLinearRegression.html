<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>multiplelinearregression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="MultipleLinearRegression_files/libs/clipboard/clipboard.min.js"></script>
<script src="MultipleLinearRegression_files/libs/quarto-html/quarto.js"></script>
<script src="MultipleLinearRegression_files/libs/quarto-html/popper.min.js"></script>
<script src="MultipleLinearRegression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MultipleLinearRegression_files/libs/quarto-html/anchor.min.js"></script>
<link href="MultipleLinearRegression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MultipleLinearRegression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MultipleLinearRegression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MultipleLinearRegression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MultipleLinearRegression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="multiple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression">Multiple Linear Regression</h2>
<p>Loading the packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.2.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.5     ✔ purrr   0.3.4
✔ tibble  3.1.6     ✔ dplyr   1.0.8
✔ tidyr   1.2.0     ✔ stringr 1.4.0
✔ readr   2.1.2     ✔ forcats 0.5.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'skimr' was built under R version 4.2.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'leaps' was built under R version 4.2.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Importing the dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>GSS <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"GSS_clean.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2348 Columns: 45
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (34): number_of_children, age_of_respondent, college_major_1, college_ma...
dbl (11): respondent_id_number, highest_year_of_school_completed, highest_ye...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>GSS stands for General Social Survey. It was conducted by the University of Chicago. I studies trends in the lives of Americans since the year 1972. The data cleaning has been conducted by Dr.&nbsp;Amelia McNamara, at the University of St.&nbsp;Thomas.</p>
<p>Checking the names of the variables in this dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GSS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "respondent_id_number"                    
 [2] "number_of_children"                      
 [3] "age_of_respondent"                       
 [4] "highest_year_of_school_completed"        
 [5] "highest_year_school_completed_father"    
 [6] "highest_year_school_completed_mother"    
 [7] "highest_year_school_completed_spouse"    
 [8] "college_major_1"                         
 [9] "college_major_2"                         
[10] "diploma_ged_or_other"                    
[11] "respondents_sex"                         
[12] "number_of_brothers_and_sisters"          
[13] "labor_force_status"                      
[14] "number_of_hours_worked_last_week"        
[15] "number_of_hours_usually_work_a_week"     
[16] "self_emp_or_works_for_somebody"          
[17] "govt_or_private_employee"                
[18] "occupation_code"                         
[19] "marital_status"                          
[20] "marital_type"                            
[21] "race_of_respondent"                      
[22] "born_in_us"                              
[23] "should_govt_reduce_income_differences"   
[24] "favor_or_oppose_death_penalty_for_murder"
[25] "should_marijuana_be_made_legal"          
[26] "rs_religious_preference"                 
[27] "specific_denomination"                   
[28] "other_protestant_denominations"          
[29] "general_happiness"                       
[30] "condition_of_health"                     
[31] "is_life_exciting_or_dull"                
[32] "ballot_used_for_interview"               
[33] "parks_and_recreation"                    
[34] "mass_transportation"                     
[35] "number_of_persons_in_household"          
[36] "total_family_income"                     
[37] "respondents_income"                      
[38] "region_of_interview"                     
[39] "size_of_place_in_1000s"                  
[40] "political_party_affiliation"             
[41] "think_of_self_as_liberal_or_conservative"
[42] "space_exploration_program"               
[43] "improving_protecting_environment"        
[44] "improving_protecting_nations_health"     
[45] "lived_in_us"                             </code></pre>
</div>
</div>
<p>We are going to predict highest_year_of_school_completed. The possible variables influencing highest_year_of_school_completed are:</p>
<ol type="1">
<li><p>highest_year_school_completed_father</p></li>
<li><p>born_in_us</p></li>
<li><p>age_of_respondent</p></li>
<li><p>number_of_brothers_and_sisters</p></li>
<li><p>highest_year_school_completed_mother</p></li>
<li><p>respondents_sex</p></li>
</ol>
<p>Let’s first separate these variables in another dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>newGSS <span class="ot">&lt;-</span> <span class="fu">select</span>(GSS, respondents_sex, highest_year_school_completed_mother, age_of_respondent, number_of_brothers_and_sisters, marital_status, born_in_us, highest_year_school_completed_father, highest_year_of_school_completed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(newGSS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">newGSS</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">2348</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 23%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">respondents_sex</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_of_respondent</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">marital_status</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">born_in_us</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 37%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">highest_year_school_completed_mother</td>
<td style="text-align: right;">259</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">11.88</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">▁▂▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">number_of_brothers_and_sisters</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.58</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">highest_year_school_completed_father</td>
<td style="text-align: right;">661</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">11.88</td>
<td style="text-align: right;">4.15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">▁▂▇▅▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">highest_year_of_school_completed</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">13.73</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">▁▁▆▇▂</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are still plenty of NA values in the dataset. Since we have 2348 respondents, w.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>newGSS<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(newGSS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I will conduct a backward elimination method to determine which variables I will keep and which ones I will remove. Since there are only 7 variables, I will conduct this manually.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a> model<span class="ot">&lt;-</span> <span class="fu">lm</span>(highest_year_of_school_completed <span class="sc">~</span> ., <span class="at">data =</span> newGSS)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = highest_year_of_school_completed ~ ., data = newGSS)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.3725  -1.7319  -0.0498   1.5283   8.7693 

Coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           7.22433    0.82626   8.743  &lt; 2e-16 ***
respondents_sexMale                  -0.21381    0.13420  -1.593 0.111330    
highest_year_school_completed_mother  0.14156    0.02574   5.501 4.46e-08 ***
age_of_respondent19                   0.19668    0.94922   0.207 0.835882    
age_of_respondent20                   1.52189    1.09087   1.395 0.163188    
age_of_respondent21                   1.81873    0.93070   1.954 0.050872 .  
age_of_respondent22                   1.37080    0.90898   1.508 0.131752    
age_of_respondent23                   1.29369    0.96043   1.347 0.178188    
age_of_respondent24                   2.47968    0.87036   2.849 0.004446 ** 
age_of_respondent25                   2.39773    0.90118   2.661 0.007883 ** 
age_of_respondent26                   2.79510    1.00241   2.788 0.005365 ** 
age_of_respondent27                   2.45380    0.91550   2.680 0.007438 ** 
age_of_respondent28                   3.60009    0.88172   4.083 4.68e-05 ***
age_of_respondent29                   3.31119    0.88120   3.758 0.000178 ***
age_of_respondent30                   3.23350    0.87793   3.683 0.000239 ***
age_of_respondent31                   2.92165    0.92472   3.159 0.001612 ** 
age_of_respondent32                   2.91043    0.88803   3.277 0.001072 ** 
age_of_respondent33                   2.35256    0.89533   2.628 0.008688 ** 
age_of_respondent34                   2.30354    0.86173   2.673 0.007597 ** 
age_of_respondent35                   2.33480    0.89711   2.603 0.009345 ** 
age_of_respondent36                   2.78273    0.87565   3.178 0.001514 ** 
age_of_respondent37                   3.10114    0.87667   3.537 0.000417 ***
age_of_respondent38                   2.58031    0.89573   2.881 0.004025 ** 
age_of_respondent39                   2.96228    0.84448   3.508 0.000465 ***
age_of_respondent40                   2.36427    0.87154   2.713 0.006750 ** 
age_of_respondent41                   2.70961    0.93262   2.905 0.003723 ** 
age_of_respondent42                   2.84852    0.88431   3.221 0.001305 ** 
age_of_respondent43                   3.71286    0.90700   4.094 4.48e-05 ***
age_of_respondent44                   4.13117    0.89947   4.593 4.74e-06 ***
age_of_respondent45                   3.20450    0.92313   3.471 0.000533 ***
age_of_respondent46                   3.02528    0.91361   3.311 0.000951 ***
age_of_respondent47                   2.34149    0.91649   2.555 0.010723 *  
age_of_respondent48                   3.33855    0.92863   3.595 0.000335 ***
age_of_respondent49                   3.24293    0.94318   3.438 0.000602 ***
age_of_respondent50                   3.10949    0.92351   3.367 0.000779 ***
age_of_respondent51                   2.54625    0.87706   2.903 0.003749 ** 
age_of_respondent52                   3.57429    0.98270   3.637 0.000285 ***
age_of_respondent53                   2.85193    0.87073   3.275 0.001080 ** 
age_of_respondent54                   2.75101    0.90982   3.024 0.002540 ** 
age_of_respondent55                   3.34783    0.88892   3.766 0.000172 ***
age_of_respondent56                   3.15173    0.88741   3.552 0.000395 ***
age_of_respondent57                   2.76939    0.92030   3.009 0.002663 ** 
age_of_respondent58                   3.36150    0.91241   3.684 0.000238 ***
age_of_respondent59                   4.14178    0.87345   4.742 2.32e-06 ***
age_of_respondent60                   3.18901    0.85730   3.720 0.000207 ***
age_of_respondent61                   3.16634    0.87774   3.607 0.000320 ***
age_of_respondent62                   3.47971    0.99047   3.513 0.000456 ***
age_of_respondent63                   3.41788    0.88684   3.854 0.000121 ***
age_of_respondent64                   3.40013    0.93247   3.646 0.000275 ***
age_of_respondent65                   4.01039    0.89883   4.462 8.74e-06 ***
age_of_respondent66                   3.18410    0.89789   3.546 0.000403 ***
age_of_respondent67                   2.56145    0.94336   2.715 0.006700 ** 
age_of_respondent68                   3.18853    0.89956   3.545 0.000406 ***
age_of_respondent69                   3.77356    0.88068   4.285 1.95e-05 ***
age_of_respondent70                   3.27750    0.86882   3.772 0.000168 ***
age_of_respondent71                   3.52438    0.91040   3.871 0.000113 ***
age_of_respondent72                   4.68323    0.97475   4.805 1.71e-06 ***
age_of_respondent73                   3.74518    1.03343   3.624 0.000300 ***
age_of_respondent74                   4.68482    0.95626   4.899 1.07e-06 ***
age_of_respondent75                   2.15837    1.08161   1.996 0.046171 *  
age_of_respondent76                   4.12458    1.02004   4.044 5.54e-05 ***
age_of_respondent77                   2.86077    0.94048   3.042 0.002393 ** 
age_of_respondent78                   3.99982    1.37779   2.903 0.003750 ** 
age_of_respondent79                   3.59148    1.48873   2.412 0.015967 *  
age_of_respondent80                   2.77346    1.18469   2.341 0.019361 *  
age_of_respondent81                   4.15949    1.29880   3.203 0.001391 ** 
age_of_respondent82                   1.54457    1.29682   1.191 0.233826    
age_of_respondent83                   4.71309    2.67371   1.763 0.078149 .  
age_of_respondent84                   4.65692    1.37324   3.391 0.000714 ***
age_of_respondent85                   6.46639    1.23362   5.242 1.82e-07 ***
age_of_respondent86                   4.19486    1.08828   3.855 0.000121 ***
age_of_respondent87                   1.57294    1.65659   0.950 0.342522    
age_of_respondent88                   1.90966    1.24644   1.532 0.125713    
age_of_respondent89 or older          2.96107    1.02528   2.888 0.003933 ** 
number_of_brothers_and_sisters       -0.11981    0.02692  -4.450 9.23e-06 ***
marital_statusMarried                 0.35817    0.19038   1.881 0.060127 .  
marital_statusNever married           0.29203    0.24158   1.209 0.226920    
marital_statusSeparated              -0.24316    0.45779  -0.531 0.595378    
marital_statusWidowed                -0.17215    0.30859  -0.558 0.577018    
born_in_usYes                         0.17015    0.21090   0.807 0.419931    
highest_year_school_completed_father  0.20253    0.02217   9.137  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.546 on 1476 degrees of freedom
Multiple R-squared:  0.2838,    Adjusted R-squared:  0.245 
F-statistic: 7.312 on 80 and 1476 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>It seems like the model is taking each age under the age_of_respondent variable as a separate category.</p>
<p>To investigate this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(newGSS<span class="sc">$</span>age_of_respondent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Length     Class      Mode 
     1557 character character </code></pre>
</div>
</div>
<p>It seems like the enteries for age_of_respondent variable are String or character. We need to convert it to numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>newGSS <span class="ot">&lt;-</span> newGSS <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_numeric =</span> <span class="fu">parse_number</span>(age_of_respondent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(newGSS<span class="sc">$</span>age_numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   35.00   49.00   49.41   63.00   89.00 </code></pre>
</div>
</div>
<p>It has now been converted to numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span> <span class="fu">lm</span>(highest_year_of_school_completed <span class="sc">~</span> respondents_sex<span class="sc">+</span> highest_year_school_completed_mother<span class="sc">+</span> number_of_brothers_and_sisters <span class="sc">+</span> marital_status <span class="sc">+</span> born_in_us <span class="sc">+</span> highest_year_school_completed_father <span class="sc">+</span> age_numeric,  <span class="at">data =</span> newGSS)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = highest_year_of_school_completed ~ respondents_sex + 
    highest_year_school_completed_mother + number_of_brothers_and_sisters + 
    marital_status + born_in_us + highest_year_school_completed_father + 
    age_numeric, data = newGSS)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.7518  -1.8673  -0.0632   1.5668   8.9593 

Coefficients:
                                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           9.103232   0.437839  20.791  &lt; 2e-16 ***
respondents_sexMale                  -0.183491   0.132765  -1.382   0.1671    
highest_year_school_completed_mother  0.148889   0.025351   5.873 5.23e-09 ***
number_of_brothers_and_sisters       -0.124121   0.026529  -4.679 3.14e-06 ***
marital_statusMarried                 0.345878   0.187578   1.844   0.0654 .  
marital_statusNever married           0.086420   0.227523   0.380   0.7041    
marital_statusSeparated              -0.173574   0.449920  -0.386   0.6997    
marital_statusWidowed                -0.441800   0.290076  -1.523   0.1280    
born_in_usYes                         0.097143   0.205820   0.472   0.6370    
highest_year_school_completed_father  0.197169   0.021831   9.032  &lt; 2e-16 ***
age_numeric                           0.025205   0.004671   5.396 7.86e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.572 on 1546 degrees of freedom
Multiple R-squared:  0.2342,    Adjusted R-squared:  0.2292 
F-statistic: 47.27 on 10 and 1546 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>It seems like marital_status is not a good predictor of highest_year_of_school_completed, thus, we eliminate that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">&lt;-</span> <span class="fu">lm</span>(highest_year_of_school_completed <span class="sc">~</span> respondents_sex<span class="sc">+</span> highest_year_school_completed_mother<span class="sc">+</span> number_of_brothers_and_sisters <span class="sc">+</span>  born_in_us <span class="sc">+</span> highest_year_school_completed_father <span class="sc">+</span> age_numeric,  <span class="at">data =</span> newGSS)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = highest_year_of_school_completed ~ respondents_sex + 
    highest_year_school_completed_mother + number_of_brothers_and_sisters + 
    born_in_us + highest_year_school_completed_father + age_numeric, 
    data = newGSS)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.6032  -1.8999  -0.0602   1.6040   8.4985 

Coefficients:
                                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           9.290957   0.388814  23.896  &lt; 2e-16 ***
respondents_sexMale                  -0.148537   0.131434  -1.130    0.259    
highest_year_school_completed_mother  0.150979   0.025370   5.951 3.29e-09 ***
number_of_brothers_and_sisters       -0.123956   0.026529  -4.672 3.23e-06 ***
born_in_usYes                         0.068433   0.204954   0.334    0.739    
highest_year_school_completed_father  0.201980   0.021771   9.277  &lt; 2e-16 ***
age_numeric                           0.022842   0.003915   5.835 6.54e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.579 on 1550 degrees of freedom
Multiple R-squared:  0.2284,    Adjusted R-squared:  0.2254 
F-statistic: 76.45 on 6 and 1550 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>It seems like born_in_us is not a good predictor, and neither is respondents_sex, however, born_in_us has a larger p-value, thus we eliminate that first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>model3<span class="ot">&lt;-</span> <span class="fu">lm</span>(highest_year_of_school_completed <span class="sc">~</span> respondents_sex<span class="sc">+</span> highest_year_school_completed_mother<span class="sc">+</span> number_of_brothers_and_sisters  <span class="sc">+</span> highest_year_school_completed_father <span class="sc">+</span> age_numeric,  <span class="at">data =</span> newGSS)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = highest_year_of_school_completed ~ respondents_sex + 
    highest_year_school_completed_mother + number_of_brothers_and_sisters + 
    highest_year_school_completed_father + age_numeric, data = newGSS)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.5891  -1.9003  -0.0455   1.6111   8.5171 

Coefficients:
                                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           9.315836   0.381498  24.419  &lt; 2e-16 ***
respondents_sexMale                  -0.149329   0.131375  -1.137    0.256    
highest_year_school_completed_mother  0.153244   0.024439   6.271 4.65e-10 ***
number_of_brothers_and_sisters       -0.124558   0.026460  -4.707 2.73e-06 ***
highest_year_school_completed_father  0.201868   0.021762   9.276  &lt; 2e-16 ***
age_numeric                           0.023061   0.003858   5.978 2.80e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.578 on 1551 degrees of freedom
Multiple R-squared:  0.2283,    Adjusted R-squared:  0.2258 
F-statistic: 91.77 on 5 and 1551 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>It seems like respondents_sex is the only non-significant predictor that needs to be eliminated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>model3<span class="ot">&lt;-</span> <span class="fu">lm</span>(highest_year_of_school_completed <span class="sc">~</span> highest_year_school_completed_mother<span class="sc">+</span> number_of_brothers_and_sisters  <span class="sc">+</span> highest_year_school_completed_father <span class="sc">+</span> age_numeric,  <span class="at">data =</span> newGSS)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = highest_year_of_school_completed ~ highest_year_school_completed_mother + 
    number_of_brothers_and_sisters + highest_year_school_completed_father + 
    age_numeric, data = newGSS)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.6726  -1.8959  -0.0251   1.6295   8.5777 

Coefficients:
                                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           9.256038   0.377889  24.494  &lt; 2e-16 ***
highest_year_school_completed_mother  0.152558   0.024434   6.244 5.50e-10 ***
number_of_brothers_and_sisters       -0.123144   0.026433  -4.659 3.45e-06 ***
highest_year_school_completed_father  0.201652   0.021764   9.266  &lt; 2e-16 ***
age_numeric                           0.022993   0.003858   5.960 3.11e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.578 on 1552 degrees of freedom
Multiple R-squared:  0.2277,    Adjusted R-squared:  0.2257 
F-statistic: 114.4 on 4 and 1552 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>It seems like all the variables now are significant predictors of highest_year_of_school_completed.</p>
<p>Equation:</p>
<p>ŷ = 9.25334 + 0.15343(highest_year_school_completed_mother) - 0.12340 (number_of_brothers_and_sisters ) + 0.20069 (highest_year_school_completed_father) + 0.02315(age_numeric).</p>
<p>where ŷ is highest_year_of_school_completed-hat.</p>
<p>We can now check whether or not the conditions for inference are met.</p>
<ol type="1">
<li>Equality of Variance and Linearity:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MultipleLinearRegression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There seems to be a slight curve in the red line showing that linearity is perhaps not as ideal as we would like. Linearity is not met.</p>
<p>Equality of Variance does seem to be met, there seems to be a fairly equal band of residuals on either side of the dotted line</p>
<ol start="2" type="1">
<li><p>Normality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MultipleLinearRegression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ol>
<p>The qq plot does show a slight deviation towards the end. Normality is not met.</p>
<p>Therefore, we cannot conduct inference from this model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newGSS, <span class="fu">aes</span>(<span class="at">x =</span> highest_year_school_completed_mother<span class="sc">+</span> number_of_brothers_and_sisters  <span class="sc">+</span> highest_year_school_completed_father <span class="sc">+</span> age_numeric, <span class="at">y =</span> highest_year_of_school_completed )) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MultipleLinearRegression_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>